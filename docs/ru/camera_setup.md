# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–º–µ—Ä—ã

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–º –∑—Ä–µ–Ω–∏–µ–º (–≤ —Ç–æ–º —á–∏—Å–ª–µ [–ø–æ–ª–µ—Ç–∞ –ø–æ ArUco-–º–∞—Ä–∫–µ—Ä–∞–º](aruco.md) –∏ [Optical Flow](optical_flow.md)) –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –∫–∞–º–µ—Ä—É, –∞ —Ç–∞–∫–∂–µ –≤—ã—Å—Ç–∞–≤–∏—Ç—å –µ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é. –£–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∫–∞–º–µ—Ä—ã.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ–∫—É—Å–∞ –∫–∞–º–µ—Ä—ã {#focus}

–î–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∏—è –ø–æ–ª–µ—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–∞–º–µ—Ä—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ñ–æ–∫—É—Å –∫–∞–º–µ—Ä—ã.

<img src="../assets/cam_setup.png" width=180 class="center zoom">

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –∫–∞–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—è [web_video_server](web_video_server.md).
2. –° –ø–æ–º–æ—â—å—é –≤—Ä–∞—â–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∏–≤–∞ –∫–∞–º–µ—Ä—ã –¥–æ–±–µ–π—Ç–µ—Å—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ä–µ–∑–∫–æ—Å—Ç–∏ –¥–µ—Ç–∞–ª–µ–π (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–æ–π –≤—ã—Å–æ—Ç—ã –ø–æ–ª–µ—Ç–∞ ‚Äì¬†2‚Äì3 –º).

|–†–∞—Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ|–°—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ|
|-|-|
|<img src="../assets/unfocused.png" width=300 class=zoom>|<img src="../assets/focused.png" width=300 class=zoom>|

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã {#frame}

–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –∫–∞–º–µ—Ä—ã [–∑–∞–¥–∞–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–µ](cli.md#editing) `~/catkin_ws/src/clover/clover/launch/main_camera.launch`: $\color{red}{\textsf{üî¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è}}$

```xml
<arg name="direction_z" default="down"/> <!-- direction the camera points: down, up -->
<arg name="direction_y" default="backward"/> <!-- direction the camera cable points: backward, forward -->
```

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∑–∞–¥–∞—Ç—å –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:

* –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–∑–æ—Ä–∞ –∫–∞–º–µ—Ä—ã `direction_z`: –≤–Ω–∏–∑ (`down`) –∏–ª–∏ –≤–≤–µ—Ä—Ö (`up`);
* –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –≤ –∫–æ—Ç–æ—Ä–æ–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç —à–ª–µ–π—Ñ –∫–∞–º–µ—Ä—ã `direction_y`: –Ω–∞–∑–∞–¥ (`backward`) –∏–ª–∏ –≤–ø–µ—Ä–µ–¥ (`forward`).

### –ü—Ä–∏–º–µ—Ä—ã

#### –ö–∞–º–µ—Ä–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–Ω–∏–∑, —à–ª–µ–π—Ñ –Ω–∞–∑–∞–¥

```xml
<arg name="direction_z" default="down"/>
<arg name="direction_y" default="backward"/>
```

<img src="../assets/camera_option_1_rviz.png" width=300>
<img src="../assets/camera_option_1_clever.jpg" width=300>

#### –ö–∞–º–µ—Ä–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–Ω–∏–∑, —à–ª–µ–π—Ñ –≤–ø–µ—Ä—ë–¥

```xml
<arg name="direction_z" default="down"/>
<arg name="direction_y" default="forward"/>
```

<img src="../assets/camera_option_2_rviz.png" width=300>
<img src="../assets/camera_option_2_clever.jpg" width=300>

#### –ö–∞–º–µ—Ä–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–≤–µ—Ä—Ö, —à–ª–µ–π—Ñ –Ω–∞–∑–∞–¥

```xml
<arg name="direction_z" default="up"/>
<arg name="direction_y" default="backward"/>
```

<img src="../assets/camera_option_3_rviz.png" width=300>
<img src="../assets/camera_option_3_clever.jpg" width=300>

#### –ö–∞–º–µ—Ä–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–≤–µ—Ä—Ö, —à–ª–µ–π—Ñ –≤–ø–µ—Ä—ë–¥

```xml
<arg name="direction_z" default="up"/>
<arg name="direction_y" default="forward"/>
```

<img src="../assets/camera_option_4_rviz.png" width=300>
<img src="../assets/camera_option_4_clever.jpg" width=300>

> **Hint** [–£—Ç–∏–ª–∏—Ç–∞ `selfcheck.py`](selfcheck.md) –≤—ã–¥–∞–µ—Ç —Å–ª–æ–≤–µ—Å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –≤ –¥–∞–Ω–Ω–æ–π –º–æ–º–µ–Ω—Ç –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞–º–µ—Ä—ã.

### –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã

–¢–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –∫–∞–º–µ—Ä—ã. –î–ª—è —ç—Ç–æ–≥–æ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∑–∞–ø—É—Å–∫ –Ω–æ–¥—ã, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–π –∫–∞–∫ `Template for custom camera orientation`:

```xml
<!-- Template for custom camera orientation -->
<!-- Camera position and orientation are represented by base_link -> main_camera_optical transform -->
<!-- static_transform_publisher arguments: x y z yaw pitch roll frame_id child_frame_id -->
<node pkg="tf2_ros" type="static_transform_publisher" name="main_camera_frame" args="0.05 0 -0.07 -1.5707963 0 3.1415926 base_link main_camera_optical"/>
```

–≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –∑–∞–¥–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é –º–µ–∂–¥—É —Ñ—Ä–µ–π–º–æ–º `base_link` ([—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–æ—Ä–ø—É—Å—É –ø–æ–ª–µ—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞](frames.md)) –∏ –∫–∞–º–µ—Ä–æ–π (`main_camera_optical`) –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```txt
—Å–¥–≤–∏–≥_x —Å–¥–≤–∏–≥_y —Å–¥–≤–∏–≥_z —É–≥–æ–ª_—Ä—ã—Å–∫–∞–Ω—å–µ —É–≥–æ–ª_—Ç–∞–Ω–≥–∞–∂ —É–≥–æ–ª_–∫—Ä–µ–Ω
```

–§—Ä–µ–π–º –∫–∞–º–µ—Ä—ã –∑–∞–¥–∞–µ—Ç—Å—è —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ:

* **<font color=red>x</font>** —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–æ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏;
* **<font color=green>y</font>** —É–∫–∞–∑—ã–≤–∞–µ—Ç –≤–Ω–∏–∑ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏;
* **<font color=blue>z</font>** —É–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ã –∫–∞–º–µ—Ä—ã.

–°–¥–≤–∏–≥–∏ –∑–∞–¥–∞—é—Ç—Å—è –≤ –º–µ—Ç—Ä–∞—Ö, —É–≥–ª—ã –∑–∞–¥–∞—é—Ç—Å—è –≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º [rviz](rviz.md).

## –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ {#calibration}

–î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ç–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫—É –∫–∞–º–µ—Ä—ã, –ø—Ä–æ—Ü–µ—Å—Å –∫–æ—Ç–æ—Ä–æ–π –æ–ø–∏—Å–∞–Ω [–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ](camera_calibration.md).
